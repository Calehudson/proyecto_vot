_format_version: "3.0"
_transform: true

services:
  - name: ms-logeo
    url: http://ms-logeo
    routes:
      - name: logeo
        paths:
          - /api/logeo
        protocols:
          - http
    plugins:
      - name: cors
        config:
          origins:
            - "*"
          methods:
            - GET
            - POST
            - PUT
            - DELETE
            - OPTIONS
          headers:
            - Accept
            - Content-Type
            - Authorization
          exposed_headers:
            - X-Custom-Header
          credentials: true
          max_age: 3600

      - name: jwt
        config:
          uri_param_names:
            - token
          claims_to_verify:
            - exp

      - name: http-log
        config:
          http_endpoint: http://auditoria:3000/logs
          method: POST
          timeout: 1000
          keepalive: 1000
          flush_timeout: 2

  - name: ms-participantes
    url: http://ms-participantes
    routes:
      - name: participantes
        paths:
          - /api/participantes
        protocols:
          - http
    plugins:
      - name: cors
        config:
          origins:
            - "*"
          methods:
            - GET
            - POST
          headers:
            - Accept
            - Content-Type
            - Authorization
          credentials: true

  - name: ms-votaciones
    url: http://ms-votaciones
    routes:
      - name: votaciones
        paths:
          - /api/votaciones
        protocols:
          - http
    plugins:
      - name: cors
        config:
          origins:
            - "*"
          methods:
            - GET
            - POST
          headers:
            - Accept
            - Content-Type
            - Authorization
          credentials: true
